# –£—Å—Ç–Ω–∞–≤–∫–∞ –æ–±—Ä–∞–∑–∞ Proxmox VE –Ω–∞ rescue system Hetzner —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º KVM

1 –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ Proxmox –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –µ–≥–æ –ø–æ–¥ –∏–º–µ–Ω–µ–º pve.iso

!!! abstract "–ö–æ–º–∞–Ω–¥–∞"

    wget -O pve.iso "link to proxmox install.iso"


2 –ü–æ–∫–∞–∑ –≤—Å–µ—Ö —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏ –∏—Ö IP-–∞–¥—Ä–µ—Å–æ–≤ –≤ Rescue Mode. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–µ–±–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Ç—Ä—Ñ–µ–π—Å–∞ –∫–æ—Ç–æ—Ä–æ–π —Å–º–æ—Ç—Ä–∏—Ç –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç.

!!! abstract "–ö–æ–º–∞–Ω–¥–∞"

    ip a

3 –ó–∞–ø—É—Å–∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö NVMe-–¥–∏—Å–∫–æ–≤ –∏ ISO Proxmox.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è UEFI BIOS (OVMF) –∏ VNC –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫—É.

!!! abstract "–ö–æ–º–∞–Ω–¥–∞"

    qemu-system-x86_64 -enable-kvm -m 8192 -smp 4 -k en-us -boot d -cdrom ./pve.iso -drive file=/dev/nvme0n1,format=raw,media=disk,if=virtio -drive file=/dev/nvme1n1,format=raw,media=disk,if=virtio -vnc :0 -bios /usr/share/OVMF/OVMF_CODE.fd 

???- info "–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã"
    –ó–∞–ø—É—Å–∫–∞–µ—Ç —ç–º—É–ª—è—Ç–æ—Ä QEMU –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã x86_64 (64-–±–∏—Ç–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã Intel/AMD).

    üîß –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"

        qemu-system-x86_64


    ‚öôÔ∏è –ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ
    –í–∫–ª—é—á–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ KVM (Kernel-based Virtual Machine) ‚Äî –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ CPU, –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -enable-kvm


    üíæ –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å
    –í—ã–¥–µ–ª—è–µ—Ç 8192 –ú–ë (8 –ì–ë) –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã.

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -m 8192


    üß† –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä CPU
    –í—ã–¥–µ–ª—è–µ—Ç 4 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö CPU (—è–¥—Ä–∞) –¥–ª—è –º–∞—à–∏–Ω—ã.

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -smp 4


    ‚å®Ô∏è –†–∞—Å–∫–ª–∞–¥–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞—Å–∫–ª–∞–¥–∫—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∞–Ω–≥–ª–∏–π—Å–∫—É—é (–°–®–ê) –¥–ª—è –≤–≤–æ–¥–∞ –≤ VM.

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -k en-us


    üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –Ω—É–∂–Ω–æ —Å CD-ROM (d ‚Äî drive d).

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -boot d

    üíø ISO-–æ–±—Ä–∞–∑ CD-ROM
    –£–∫–∞–∑—ã–≤–∞–µ—Ç ISO-—Ñ–∞–π–ª pve.iso (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —ç—Ç–æ Proxmox VE), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ CD-ROM.

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -cdrom ./pve.iso


    üñ¥ –ñ–µ—Å—Ç–∫–∏–π –¥–∏—Å–∫ (–ø–µ—Ä–≤—ã–π)
    –ü–æ–¥–∫–ª—é—á–∞–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∏—Å–∫ /dev/nvme0n1 –∫–∞–∫ –¥–∏—Å–∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã:

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -drive file=/dev/nvme0n1,format=raw,media=disk,if=virtio

    * format=raw ‚Äî –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±–µ–∑ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π

    * media=disk ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç—Å—è –∫–∞–∫ HDD/SSD

    * if=virtio ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è VirtIO-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è QEMU/KVM)

    üñ¥ –ñ–µ—Å—Ç–∫–∏–π –¥–∏—Å–∫ (–≤—Ç–æ—Ä–æ–π)
    –¢–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –¥–∏—Å–∫–∞ /dev/nvme1n1.

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -drive file=/dev/nvme1n1,format=raw,media=disk,if=virtio


    üñ•Ô∏è –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥
    –ó–∞–ø—É—Å–∫–∞–µ—Ç –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∏—Ä—Ç—É–∞–ª–∫–∏ —á–µ—Ä–µ–∑ VNC-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É :0, —Ç–æ –µ—Å—Ç—å TCP –ø–æ—Ä—Ç 5900. –ú–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ VNC-–∫–ª–∏–µ–Ω—Ç.

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -vnc :0


    üß¨ UEFI BIOS
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç UEFI-–ø—Ä–æ—à–∏–≤–∫—É –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞ OVMF (Open Virtual Machine Firmware) –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ BIOS. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è UEFI-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –û–°.

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        -bios /usr/share/OVMF/OVMF_CODE.fd

–î–∞–ª—å—à–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –ø–æ VNC –∏ –¥–µ–ª–∞–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É –≤ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ. –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Proxmox –≤ –∫–æ–Ω—Å–æ–ª–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

!!! abstract "–ö–æ–º–∞–Ω–¥–∞"
    nano /etc/network/interfaces

–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∏–∑–∏—á–µ–∫–∏–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —É–∂–µ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã–º –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–º 

???- info "–í —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –Ω–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç—Ä–æ–≤–∞–ª–∏ —Å–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∑–∞–≥—É–∂–∞–µ–º—Å—è –≤ rescue system"
    –ò–º–ø–æ—Ä—Ç –ø—É–ª–∞ ZFS —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
    -R /mnt  - –∑–∞–¥–∞—ë—Ç root-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º –ø—É–ª–∞
    -f  - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ ZFS —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –ø—É–ª —É–∂–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω

    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        zpool import -f -R /mnt rpool

    –î–∞–ª—å—à–µ –∫–æ–º–∞–Ω–¥–æ–π cd /mmt –∑–∞—Ö–æ–¥–∏—Ç –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–∫–µ–º –∫–æ–Ω—Ñ–∏–≥ —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ä—Ñ–µ–π—Å–∞ –∏–Ω—Ç—Ä—Ñ–µ–π—Å–∞ 

    –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ (—ç–∫—Å–ø–æ—Ä—Ç) –ø—É–ª–∞ ZFS –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π.
    !!! abstract "–ö–æ–º–∞–Ω–¥–∞"
        zpool export rpool
