<!DOCTYPE html><html lang="ru" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Support Vadim">
      
      
        <link rel="canonical" href="https://Zakonn1k.github.io/MkDocs-manual/SQL/rezervnoe-kopirovanie-i-vosstanovlenie-bazy-dannykh-v-ms-sql-server/">
      
      
        <link rel="prev" href="../bazy-dannykh-neskolko-shagov-do-sereznogo-obsluzhivaniia/">
      
      
        <link rel="next" href="../../blog/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Резервное копирование и восстановление базы данных в MS SQL Server - Support Vadim Manual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ms-sql-server" class="md-skip">
          Перейти к содержанию
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Верхний колонтитул">
    <a href="../.." title="Support Vadim Manual" class="md-header__button md-logo" aria-label="Support Vadim Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Support Vadim Manual
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Резервное копирование и восстановление базы данных в MS SQL Server
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to system preference" type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Поиск" placeholder="Поиск" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Поиск">
        
        <button type="reset" class="md-search__icon md-icon" title="Очистить" aria-label="Очистить" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Инициализация поиска
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Навигация" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Support Vadim Manual" class="md-nav__button md-logo" aria-label="Support Vadim Manual" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    Support Vadim Manual
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome to Support Vadim
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cisco
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cisco
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Cisco/firmware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Прошивка Cisco Catalyst 3850
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Linux
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/NFS%20%D0%B2%20Linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NFS в Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/access-rights/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Добавления ключа SSH
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Установка Debian 12.10.0 (Netinst, XFCE)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/kak-ustanovit-aktualnye-versii-docker-i-docker-compose-na-ubuntu-i-debian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Как установить актуальные версии Docker и Docker Compose на Ubuntu и Debian
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux/prometheus-grafana/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Установка и настройка Prometheus и Grafana (Docker)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4">
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    MikroTik
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    MikroTik
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MikroTik/instruktsii-po-nastroike-mikrotik/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Инструкции по настройке MikroTik
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MikroTik/mikrotik-capsman-nastroika-capsman-v-mikrotik-routeros-713-i-vyshe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Настройка CAPsMAN в Mikrotik RouterOS 7
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    SQL
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    SQL
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2389984/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Как установить SQL Server 2019 для работы с 1С
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bazy-dannykh-neskolko-shagov-do-sereznogo-obsluzhivaniia/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Обслуживания базы данных
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Резервное копирование и восстановление базы данных в MS SQL Server
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Резервное копирование и восстановление базы данных в MS SQL Server
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sql-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Типы резервного копирования SQL Server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Типы резервного копирования SQL Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#full-backup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Полное (Full Backup)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Дифференциальное
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Журнал транзакций
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tail-log" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tail-Log
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        Copy-only
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Частичная резервная копия
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Резервное копирование файлов и файловых групп
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-server_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Модели восстановления базы данных SQL Server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Модели восстановления базы данных SQL Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Простая модель восстановления
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Полная модель восстановления
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-logged" class="md-nav__link">
    <span class="md-ellipsis">
      
        Восстановление с неполным протоколированием (bulk logged)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-server_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Настройка резервного копирования SQL Server с помощью плана обслуживания
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-server_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Восстановление базы данных SQL Server из резервной копии
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Восстановление базы данных SQL Server из резервной копии">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-server-management-studio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Восстановление резервной копии с помощью SQL Server Management Studio
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ms-sql-server-t-sql" class="md-nav__link">
    <span class="md-ellipsis">
      
        Восстановление базы данных MS SQL Server с помощью T-SQL
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6">
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/sell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Page 2 test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3">
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Архив
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Архив
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7">
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Виртуалки
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Виртуалки
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%BA%D0%B8/Install-Proxmox-KVM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Устнавка образа Proxmox VE на rescue system Hetzner с виртуальным KVM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%BA%D0%B8/MikrotikCHR-Proxmox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Установка Mikrotik CHR на Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%BA%D0%B8/Proxmox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Установка Proxmox VE на голый on Debian 12
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../%D0%92%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%BA%D0%B8/Settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Настройка сети Proxmox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sql-server" class="md-nav__link">
    <span class="md-ellipsis">
      
        Типы резервного копирования SQL Server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Типы резервного копирования SQL Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#full-backup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Полное (Full Backup)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Дифференциальное
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Журнал транзакций
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tail-log" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tail-Log
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-only" class="md-nav__link">
    <span class="md-ellipsis">
      
        Copy-only
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Частичная резервная копия
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        Резервное копирование файлов и файловых групп
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-server_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Модели восстановления базы данных SQL Server
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Модели восстановления базы данных SQL Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        Простая модель восстановления
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        Полная модель восстановления
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-logged" class="md-nav__link">
    <span class="md-ellipsis">
      
        Восстановление с неполным протоколированием (bulk logged)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-server_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Настройка резервного копирования SQL Server с помощью плана обслуживания
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-server_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Восстановление базы данных SQL Server из резервной копии
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Восстановление базы данных SQL Server из резервной копии">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-server-management-studio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Восстановление резервной копии с помощью SQL Server Management Studio
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ms-sql-server-t-sql" class="md-nav__link">
    <span class="md-ellipsis">
      
        Восстановление базы данных MS SQL Server с помощью T-SQL
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ms-sql-server">Резервное копирование и восстановление базы данных в MS SQL Server<a class="headerlink" href="#ms-sql-server" title="Permanent link">¶</a></h1>
<p>В этой статье мы рассмотрим, как настроить резервное копирование баз данных в Microsoft SQL Server, покажем, как восстановить базу данных из резервной копии с помощью SQL Server Management Studio и Transact-SQL. Первая часть статьи посвящена теоретическим аспектам резервного копирование в SQL, во второй на примере мы покажем, как настроить регулярное резервное копирование базы данных MS SQL с помощью плана обслуживания и восстановить базу из резервной копии на примере <a href="https://winitpro.ru/index.php/2020/01/15/guide-ustanovka-ms-sql-server-best-practices/">установленного Microsoft SQL Server 2019</a>.</p>
<p>Требования к плану резервного копирования баз данных SQL Server устанавливает бизнес, учитывая несколько критериев:</p>
<ul>
<li>Допустимый объём потерянных данных (за последний день/час/минуту/секунду);</li>
<li>Требования к дисковому пространству и его стоимость;</li>
<li>Затраты ресурсов сервера на резервное копирование.</li>
</ul>
<p>Следует понимать, что с помощью механизмов резервного копирования невозможно добиться резервирования данных в реальном времени. Для этой цели используются другие технологии <a href="https://winitpro.ru/index.php/2020/01/28/vysokaya-dostupnost-dannih-mssql-server/">высокой доступности</a> SQL Server – <a href="https://winitpro.ru/index.php/2020/02/03/nastrojka-always-on-mssql-server/">группы доступности Always On</a>, зеркалирование баз данных или <a href="https://winitpro.ru/index.php/2020/02/13/nastrojka-replikacii-v-sql-server/">репликация</a>.</p>
<p>Содержание:</p>
<ul>
<li><a href="#sql-server">Типы резервного копирования SQL Server</a></li>
<li><a href="#sql-server_1">Модели восстановления базы данных SQL Server</a></li>
<li><a href="#sql-server_2">Настройка резервного копирования SQL Server с помощью плана обслуживания</a></li>
<li><a href="#sql-server_3">Восстановление базы данных SQL Server из резервной копии</a></li>
</ul>
<h2 id="sql-server">Типы резервного копирования SQL Server<a class="headerlink" href="#sql-server" title="Permanent link">¶</a></h2>
<h3 id="full-backup">Полное (Full Backup)<a class="headerlink" href="#full-backup" title="Permanent link">¶</a></h3>
<p>Полное резервное копирование делает копию всей базы данных, включая все объекты и данные системных таблиц. Полная резервная копия не будет усекать (truncate) журнал транзакций. Это основной тип резервных копий, который требуется выполнять перед другими типами резервных копий.</p>
<p>Полную резервную копию вы можете восстановить за 1 шаг, так как она не требует других дифференциальных/инкрементальных копий.</p>
<p>Если модель восстановления базы SQL данных установлена как “Полная”, то при восстановлении бекапа вы можете указать параметр “<strong>STOPAT</strong>”, где указывается время (до секунды) на котором нужно остановить восстановление данных. Например, сотрудник внёс некорректные данные в 14:46:07, с помощью параметра STOPAT вы можете восстановить данные на момент 14:46:06</p>
<h3 id="_1">Дифференциальное<a class="headerlink" href="#_1" title="Permanent link">¶</a></h3>
<p>Дифференциальное или разностное резервное копирование — это копирование только тех данных, которые появились с момента последней полной резервной копии.</p>
<p>Данный тип резервного копирования используют совместно с полной резервной копией, так как для восстановления дифференциальной копии необходима полная резервная копия.</p>
<p>Обычно при использовании разностного резервного копирования используют план по типу “полное раз в N дней, дифференциальное каждые N часов”. Если ежедневный оборот данных достаточно высокий, то данный тип резервных копий может быть неудобен в применении, так как копии будут весить довольно много.</p>
<p>Например, если полная резервная копия весит 300 GB, а дифференциальная спустя час работы 5 GB, то спустя сутки это будет 120 GB, что делает использование данного типа копий нерациональным.</p>
<h3 id="_2">Журнал транзакций<a class="headerlink" href="#_2" title="Permanent link">¶</a></h3>
<p>Резервное копирования журнала транзакций копирует все транзакции, которые произошли с момента последнего резервного копирования, а затем урезает журнал транзакций для освобождения дискового пространства.</p>
<p>Восстанавливая журнал транзакций, вы также можете указать параметр STOPAT, как и в восстановлении полной резервной копии.</p>
<p>Этот тип бекапа является инкрементальным, поэтому для восстановления базы данных вам потребуется вся цепочка резервных копий: Полная и все последующие инкрементальные журнала транзакций.</p>
<h3 id="tail-log">Tail-Log<a class="headerlink" href="#tail-log" title="Permanent link">¶</a></h3>
<p>Этот вид резервного копирования выделяют как отдельный, но фактически это обычная резервная копия журнала транзакций с NORECOVERY опцией.</p>
<p>Tail-Log бекап рекомендуется делать перед восстановлением копий журнала транзакций, чтобы не потерять транзакции между последним бекапом и текущим моментом времени.</p>
<h3 id="copy-only">Copy-only<a class="headerlink" href="#copy-only" title="Permanent link">¶</a></h3>
<p>Этот вид бекапа не может служить “базой” для дифференциальных резервных копий и для копий журнала транзакций. Copy-only бекап не нарушает текущую цепочку резервных копий (полный-&gt; дифференциальный или полный -&gt; копии журналов транзакций) и используется только в том случае, если вам нужно снять полную резервную копию, не задевая текущую цепочку бекапов.</p>
<p>За исключением этих нюансов – ничем не отличается от обычной полной копии.</p>
<h3 id="_3">Частичная резервная копия<a class="headerlink" href="#_3" title="Permanent link">¶</a></h3>
<p>Partial backup этот тип резервной копии используется для того, чтобы снять копии с read-only файловых групп. На практике используется редко.</p>
<h3 id="_4">Резервное копирование файлов и файловых групп<a class="headerlink" href="#_4" title="Permanent link">¶</a></h3>
<p>Используется для снятия резервных копий определенных файлов или файловых групп.</p>
<h2 id="sql-server_1">Модели восстановления базы данных SQL Server<a class="headerlink" href="#sql-server_1" title="Permanent link">¶</a></h2>
<p>Модель восстановления – это параметр базы данных SQL Server, который отвечает за регистрацию транзакций в журнале транзакций. Всего существует три модели восстановления:</p>
<h3 id="_5">Простая модель восстановления<a class="headerlink" href="#_5" title="Permanent link">¶</a></h3>
<p>Автоматически урезает журналы транзакций, освобождая место на диске. Вручную журналы транзакций обслуживать не нужно.</p>
<p>В случае аварии, данные могут быть восстановлены только на момент снятия резервной копии.</p>
<p>При использовании этой модели восстановления, следующий функционал SQL Server недоступен:</p>
<ul>
<li>Доставка журналов транзакций</li>
<li>Always On</li>
<li>Point-In-Time восстановление</li>
<li>Резервные копии журнала транзакций</li>
</ul>
<h3 id="_6">Полная модель восстановления<a class="headerlink" href="#_6" title="Permanent link">¶</a></h3>
<p>Полная модель восстановления хранит все транзакции в журнале транзакций до усечения журнала (посредством снятия резервной копии журнала).</p>
<p>Это самая “надежная” модель восстановления, при аварийном сбое можно вы сможете восстановить все транзакции, кроме тех, которые не успели завершиться при аварии.</p>
<p>Эта модель нуждается в обслуживании журналов транзакций (регулярные резервные копии), иначе журналы займут всё дисковое пространство.</p>
<h3 id="bulk-logged">Восстановление с неполным протоколированием (bulk logged)<a class="headerlink" href="#bulk-logged" title="Permanent link">¶</a></h3>
<p>Эта модель, также, как и полная, записывает все транзакции в журнал транзакций, за исключением таких операций как:</p>
<ul>
<li>SELECT INTO</li>
<li>BULK INSERT и BCP</li>
<li>INSERT INTO SELECT</li>
<li>Операции с индексами (CREATE INDEX, ALTER INDEX REBUILD, DROP INDEX)</li>
</ul>
<p>В остальном эта модель работает аналогично полной модели восстановления.</p>
<h2 id="sql-server_2">Настройка резервного копирования SQL Server с помощью плана обслуживания<a class="headerlink" href="#sql-server_2" title="Permanent link">¶</a></h2>
<p>Планы обслуживания SQL Server это самый распространенный способ настройки регулярного резервного копирования.</p>
<p>Рассмотрим настройку резервного базы данных на SQL Server копирования по плану:</p>
<ul>
<li>Полная резервная копия каждые 24 часа</li>
<li>Копия журнала транзакций – каждые 30 минут</li>
</ul>
<p>В SSMS (SQL Server Management Studio) перейдите в раздел Management -&gt; Maintenance Planes и запустите -&gt; мастер создания плана обслуживания (Maintenance Plan Wizard).</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/sozdat-plan-obsluzhivaniya-dlya-rezevnogo-kopirovani.png" data-desc-position="bottom"><img alt="создать план обслуживания для резевного копирования slq server" src="../img/sozdat-plan-obsluzhivaniya-dlya-rezevnogo-kopirovani.png"></a></p>
<p>Укажите имя плана и выберите режим “Separate schedules for each task”.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/plan-rezevnogo-kopirovaniya-slq-server.png" data-desc-position="bottom"><img alt="план резевного копирования slq server" src="../img/plan-rezevnogo-kopirovaniya-slq-server.png"></a></p>
<p>Выберите операции, которые нужно сделать в этом плане обслуживания:</p>
<ul>
<li>Back Up Database (Full)</li>
<li>Back Up Database (Transaction Log)</li>
</ul>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/rezevnoe-kopirovanie-bazy-dannyh-i-tranzakcionnogo.png" data-desc-position="bottom"><img alt="резевное копирование базы данных и транзакционного лога sql server" src="../img/rezevnoe-kopirovanie-bazy-dannyh-i-tranzakcionnogo.png"></a></p>
<p>Используйте следующую последовательность операций:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/posledovatelnost-rezevnogo-kopirovaniya-v-plane-o.png" data-desc-position="bottom"><img alt="последовательность резевного копирования в плане обслуживания sql" src="../img/posledovatelnost-rezevnogo-kopirovaniya-v-plane-o.png"></a></p>
<p>Выберите базу данных SQL Server, которую нужно бэкапить и выберите расписание.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/vybora-bazy-dannyh-mssql-dlya-rezevnogo-kopirovaniya.png" data-desc-position="bottom"><img alt="выбора базы данных mssql для резевного копирования" src="../img/vybora-bazy-dannyh-mssql-dlya-rezevnogo-kopirovaniya.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/raspisanie-rezevnogo-kopirovaniya-bd-mssql.png" data-desc-position="bottom"><img alt="расписание резевного копирования бд mssql" src="../img/raspisanie-rezevnogo-kopirovaniya-bd-mssql.png"></a></p>
<p>Укажите путь к каталогу, в который нужно сохранять резервные копию ваше базы данных.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/katalog-dlya-rezevnyh-kopij.png" data-desc-position="bottom"><img alt="каталог для резевных копий" src="../img/katalog-dlya-rezevnyh-kopij.png"></a></p>
<p>Укажите сколько будут храниться резервные копии (например, 14 дней).</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/glubina-hraneniya-rezevnyh-kopij-sql-server.png" data-desc-position="bottom"><img alt="глубина хранения резевных копий sql server" src="../img/glubina-hraneniya-rezevnyh-kopij-sql-server.png"></a></p>
<p>Нажмите Next и аналогично создайте расписание резервного копирования для журнала транзакций.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/nastrojka-rezevnogo-kopirovaniya-zhurnala-tranzakcij.png" data-desc-position="bottom"><img alt="настройка резевного копирования журнала транзакций microsoft sql server" src="../img/nastrojka-rezevnogo-kopirovaniya-zhurnala-tranzakcij.png"></a></p>
<p>Опционально можно указать файл для ведения лога плана обслуживания.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/log-bekapa-sql-server.png" data-desc-position="bottom"><img alt="лог бэкапа sql server" src="../img/log-bekapa-sql-server.png"></a></p>
<p>Завершение настройки плана обслуживания SQL Server.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/plan-obsluzhivaniya-sql-server-sozdan.png" data-desc-position="bottom"><img alt="план обслуживания sql server создан" src="../img/plan-obsluzhivaniya-sql-server-sozdan.png"></a></p>
<p>Выполните план обслуживания вручную и проверьте журнал.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/zapuska-plana-obsluzhivaniya-proverka-rezevnogo-kop.png" data-desc-position="bottom"><img alt="запуска плана обслуживания, проверка резевного копирования mssql" src="../img/zapuska-plana-obsluzhivaniya-proverka-rezevnogo-kop.png"></a></p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/data-poslednego-rezevnogo-kopirovaniya-sql-server.png" data-desc-position="bottom"><img alt="дата последнего резевного копирования sql server" src="../img/data-poslednego-rezevnogo-kopirovaniya-sql-server.png"></a></p>
<p>Как вы видите была создана полная резервная копия базы данных SQL Server и следом копия журнала транзакций. На этом настройка резервного копирования закончена.</p>
<h2 id="sql-server_3">Восстановление базы данных SQL Server из резервной копии<a class="headerlink" href="#sql-server_3" title="Permanent link">¶</a></h2>
<p>Теперь рассмотрим, как восстановить базы данных SQL Server из резервной копии. Для восстановления базы можно использовать графическую консоль SQL Server Management Studio или язык T-SQL.</p>
<h3 id="sql-server-management-studio">Восстановление резервной копии с помощью SQL Server Management Studio<a class="headerlink" href="#sql-server-management-studio" title="Permanent link">¶</a></h3>
<p>Запустите SSMS, щелкните по разделу Database и выберите пункт Restore Database.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/vosstanovlenie-bazy-dannyh-v-sql-server.png" data-desc-position="bottom"><img alt="восстановление базы данных в SQL server" src="../img/vosstanovlenie-bazy-dannyh-v-sql-server.png"></a></p>
<p>Выберите базу данных. В окне появится список резервных копий, зарегистрированных в SQL Server для этой базы данных.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/vybora-bazy-dannyh-sql-dlya-vosstanovleniya.png" data-desc-position="bottom"><img alt="выбора базы данных sql для восстановления" src="../img/vybora-bazy-dannyh-sql-dlya-vosstanovleniya.png"></a></p>
<p>Для примера, воспользуемся Point-In-Time восстановлением и выберем момент, на который мы хотим восстановить базу данных. Нажмите Timeline.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/vybor-daty-sozdaniya-rezevnoj-kopii.png" data-desc-position="bottom"><img alt="выбор даты создания резевной копии" src="../img/vybor-daty-sozdaniya-rezevnoj-kopii.png"></a></p>
<p>Выберите опцию “<strong>Close existing connections to destination database</strong>”, если ваша база данных находится в статус Online</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../img/parametry-vosstanovleniya-bazy-dannyh-sql-server-iz.png" data-desc-position="bottom"><img alt="параметры восстановления базы данных sql server из резевной копии" src="../img/parametry-vosstanovleniya-bazy-dannyh-sql-server-iz.png"></a></p>
<p>Нажмите ОК. После этого база данных восстановится на выбранный момент времени.</p>
<h3 id="ms-sql-server-t-sql">Восстановление базы данных MS SQL Server с помощью T-SQL<a class="headerlink" href="#ms-sql-server-t-sql" title="Permanent link">¶</a></h3>
<p>Рассмотрим небольшой Transact-SQL скрипт, который выполняет ту же последовательность действия для восстановления базы данных, что и мастер (скрипт был сгенерирован мастером из примера выше).</p>
<div class="language-ps1 highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">USE</span> <span class="no">[master]</span>  
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">ALTER</span> <span class="n">DATABASE</span> <span class="no">[TestDatabase2]</span> <span class="nb">SET </span><span class="n">SINGLE_USER</span> <span class="n">WITH</span> <span class="n">ROLLBACK</span> <span class="n">IMMEDIATE</span>  
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">BACKUP</span> <span class="n">LOG</span> <span class="no">[TestDatabase2]</span> <span class="n">TO</span> <span class="n">DISK</span> <span class="p">=</span> <span class="n">N</span><span class="s1">'E:\MSSQL15.NODE2\MSSQL\Backup\TestDatabase2_LogBackup_2020-02-17_15-39-43.bak'</span> <span class="n">WITH</span> <span class="n">NOFORMAT</span><span class="p">,</span> <span class="n">NOINIT</span><span class="p">,</span> <span class="n">NAME</span> <span class="p">=</span> <span class="n">N</span><span class="s1">'TestDatabase2_LogBackup_2020-02-17_15-39-43'</span><span class="p">,</span> <span class="n">NOSKIP</span><span class="p">,</span> <span class="n">NOREWIND</span><span class="p">,</span> <span class="n">NOUNLOAD</span><span class="p">,</span> <span class="n">NORECOVERY</span><span class="p">,</span> <span class="n">STATS</span> <span class="p">=</span> <span class="n">5</span>  
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">RESTORE</span> <span class="n">DATABASE</span> <span class="no">[TestDatabase2]</span> <span class="n">FROM</span> <span class="n">DISK</span> <span class="p">=</span> <span class="n">N</span><span class="s1">'E:\MSSQL15.NODE2\MSSQL\Backup\full.bak'</span> <span class="n">WITH</span> <span class="n">FILE</span> <span class="p">=</span> <span class="n">1</span><span class="p">,</span> <span class="n">NORECOVERY</span><span class="p">,</span> <span class="n">NOUNLOAD</span><span class="p">,</span> <span class="n">STATS</span> <span class="p">=</span> <span class="n">5</span>  
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">RESTORE</span> <span class="n">LOG</span> <span class="no">[TestDatabase2]</span> <span class="n">FROM</span> <span class="n">DISK</span> <span class="p">=</span> <span class="n">N</span><span class="s1">'E:\MSSQL15.NODE2\MSSQL\Backup\trans.bak'</span> <span class="n">WITH</span> <span class="n">FILE</span> <span class="p">=</span> <span class="n">1</span><span class="p">,</span> <span class="n">NORECOVERY</span><span class="p">,</span> <span class="n">NOUNLOAD</span><span class="p">,</span> <span class="n">STATS</span> <span class="p">=</span> <span class="n">5</span>  
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">RESTORE</span> <span class="n">LOG</span> <span class="no">[TestDatabase2]</span> <span class="n">FROM</span> <span class="n">DISK</span> <span class="p">=</span> <span class="n">N</span><span class="s1">'E:\MSSQL15.NODE2\MSSQL\Backup\trans.bak'</span> <span class="n">WITH</span> <span class="n">FILE</span> <span class="p">=</span> <span class="n">2</span><span class="p">,</span> <span class="n">NOUNLOAD</span><span class="p">,</span> <span class="n">STATS</span> <span class="p">=</span> <span class="n">5</span><span class="p">,</span> <span class="n">STOPAT</span> <span class="p">=</span> <span class="n">N</span><span class="s1">'2020-02-17T15:38:23'</span>  
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">ALTER</span> <span class="n">DATABASE</span> <span class="no">[TestDatabase2]</span> <span class="nb">SET </span><span class="n">MULTI_USER</span>  
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">GO</span>
</span></code></pre></div>
<p>В данном случае база данных переводится в <strong>SINGLE_USER</strong>, но нужно быть аккуратным с этим параметром, так как в некоторых ситуациях вы можете закрыть себе доступ, если кто-то откроет сессию раньше вас.</p>
<p>Дальше выполняется tail-log бекап, затем восстанавливается полный бекап и следом восстанавливаются бекапы журнала транзакций. Обратите внимание на параметр STOPAT, база данных восстановиться на момент 15:38:23</p>
<h1 id="best-practice-sql-server">Рекомендации и best practice по резервному копированию SQL Server<a class="headerlink" href="#best-practice-sql-server" title="Permanent link">¶</a></h1>
<ul>
<li><strong>Резервные копии не должны храниться на том же диске, что и ваш SQL Server</strong>. Это правило касается любых резервных копий. При выходе из строя основного дискового массива вы должны иметь доступ к вашим резервным копиям. Если позволяют ресурсы, лучше хранить резервные копии сразу на нескольких разрозненных массивах.</li>
<li><strong>Процесс резервного копирования должен минимально влиять на работу пользователей</strong>. Полные резервные копии лучше делать тогда, когда пользовательская активность на сервере минимальна.</li>
<li><strong>Регулярно проверяйте целостность резервных копий и проводите тестовые восстановления</strong>. Вы всегда должны быть уверены, что ваши бекапы валидны и готовы к восстановлению в любое время.</li>
<li><strong>Заранее рассчитайте время, необходимое для полного восстановления при аварии</strong>. Часто в базах хранится критически важная для бизнеса информация, поэтому ваш руководитель должен знать минимальное время, которое потребуется для восстановления после аварии. Если даже вас об этом не спрашивают, лучше заранее уведомить об этом, чтобы в случае аварии не возникло недопонимания.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Support Vadim, 2025
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.instant"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0444\u0435\u0440", "clipboard.copy": "\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440", "search.result.more.one": "\u0415\u0449\u0451 1 \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.more.other": "\u0415\u0449\u0451 # \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.none": "\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e", "search.result.one": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e 1 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435", "search.result.other": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439: #", "search.result.placeholder": "\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430", "search.result.term.missing": "\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442", "select.version": "\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0435\u0440\u0441\u0438\u044e"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>